{"version":3,"sources":["../../assets/app.js"],"names":["constraints","email","presence","message","name","newsletter","form","document","querySelector","addEventListener","ev","preventDefault","handleFormSubmit","inputs","querySelectorAll","i","length","item","errors","validate","showErrorsForInput","showErrors","submitForm","_","each","input","formGroup","closestParent","parentNode","messages","resetFormGroup","classList","add","error","addError","child","className","contains","remove","el","removeChild","block","createElement","innerText","appendChild","request","XMLHttpRequest","open","send","FormData","onload","status","response","JSON","parse","responseText","success","getElementById","style","display","alert","map","pointerEvents"],"mappings":"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","file":"app.js","sourcesContent":["(function () {\n// Validate form\n\tconst constraints = {\n\t\temail: {\n\t\t\t// Email is required\n\t\t\tpresence: {\n\t\t\t\tmessage: \"^Jak vám dáme vědět, když nám nedáte e-mail? :)\"\n\t\t\t},\n\t\t\t// and must be an email (duh)\n\t\t\temail: {\n\t\t\t\tmessage: \"^Nějak se nám to nezdá, je váš e-mail v pořádku?\"\n\t\t\t}\n\t\t},\n\t\tname: {\n\t\t\tpresence: {\n\t\t\t\tmessage: \"^Napište nám prosím vaše jméno.\"\n\t\t\t}\n\t\t},\n\t\tnewsletter: {\n\t\t\tpresence: false\n\t\t}\n\t};\n\n// Hook up the form so we can prevent it from being posted\n\tlet form = document.querySelector(\"form\");\n\n\tform.addEventListener(\"submit\", function (ev) {\n\t\tev.preventDefault();\n\n\t\thandleFormSubmit(form);\n\t});\n\n// Hook up the inputs to validate on the fly\n\tlet inputs = document.querySelectorAll(\"input\");\n\n\tfor (let i = 0; i < inputs.length; ++i) {\n\t\tinputs.item(i).addEventListener(\"change\", function (ev) {\n\t\t\tlet errors = validate(form, constraints) || {};\n\n\t\t\tshowErrorsForInput(this, errors[this.name])\n\t\t});\n\t}\n\n\tfunction handleFormSubmit(form) {\n\t\t// validate the form against the constraints\n\t\tlet errors = validate(form, constraints);\n\n\t\t// then we update the form to reflect the results\n\t\tshowErrors(form, errors || {});\n\n\t\tif (!errors) {\n\t\t\tsubmitForm(form);\n\t\t}\n\t}\n\n\t// Updates the inputs with the validation errors\n\tfunction showErrors(form, errors) {\n\t\t// We loop through all the inputs and show the errors for that input\n\t\t_.each(form.querySelectorAll(\"input[name]\"), function (input) {\n\t\t\t// Since the errors can be null if no errors were found we need to handle\n\t\t\t// that\n\t\t\tshowErrorsForInput(input, errors && errors[input.name]);\n\t\t});\n\t}\n\n\t// Shows the errors for a specific input\n\tfunction showErrorsForInput(input, errors) {\n\t\t// This is the root of the input\n\t\tlet formGroup = closestParent(input.parentNode, \"newsletter__input-group\");\n\n\t\tif (formGroup !== null) {\n\t\t\t// Find where the error messages will be insert into\n\t\t\tlet messages = formGroup.querySelector(\".errors\");\n\n\t\t\t// First we remove any old messages and resets the classes\n\t\t\tresetFormGroup(formGroup);\n\t\t\t// If we have errors\n\t\t\tif (errors) {\n\t\t\t\t// we first mark the group has having errors\n\t\t\t\tformGroup.classList.add(\"has-error\");\n\t\t\t\t// then we append all the errors\n\t\t\t\t_.each(errors, function (error) {\n\t\t\t\t\taddError(messages, error);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// otherwise we simply mark it as success\n\t\t\t\tformGroup.classList.add(\"has-success\");\n\t\t\t}\n\t\t}\n\t}\n\n\t// Recursively finds the closest parent that has the specified class\n\tfunction closestParent(child, className) {\n\t\tif (!child || child == document) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (child.classList.contains(className)) {\n\t\t\treturn child;\n\t\t} else {\n\t\t\treturn closestParent(child.parentNode, className);\n\t\t}\n\t}\n\n\tfunction resetFormGroup(formGroup) {\n\t\t// Remove the success and error classes\n\t\tformGroup.classList.remove(\"has-error\");\n\t\tformGroup.classList.remove(\"has-success\");\n\t\t// and remove any old messages\n\t\t_.each(formGroup.querySelectorAll(\".help-block.error\"), function (el) {\n\t\t\tel.parentNode.removeChild(el);\n\t\t});\n\t}\n\n\t// Adds the specified error with the following markup\n\t// <p class=\"help-block error\">[message]</p>\n\tfunction addError(messages, error) {\n\t\tlet block = document.createElement(\"p\");\n\t\tblock.classList.add(\"help-block\");\n\t\tblock.classList.add(\"error\");\n\t\tblock.innerText = error;\n\t\tmessages.appendChild(block);\n\t}\n\n\tfunction submitForm(form) {\n\t\tconst request = new XMLHttpRequest();\n\t\trequest.open(\"POST\", \"api/newsletter.php\");\n\t\trequest.send(new FormData(form));\n\n\t\trequest.onload = function () {\n\t\t\t// Success!\n\t\t\tif (request.status >= 200 && request.status < 400) {\n\t\t\t\tconst response = JSON.parse(request.responseText);\n\n\t\t\t\tif (response.success === true) {\n\t\t\t\t\tdocument.getElementById('newsletter__form').style.display = 'none';\n\t\t\t\t\tdocument.getElementById('newsletter__success-message').style.display = 'block';\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\talert('false');\n\t\t\t\t// We reached our target server, but it returned an error\n\t\t\t}\n\t\t};\n\t}\n})();\n\n// Disable map scroll\nlet map = document.getElementById('map');\n\nmap.addEventListener('click', () => {\n\tmap.querySelector('iframe').style.pointerEvents = 'auto';\n}, false);\n\nmap.addEventListener('mouseleave', () => {\n\tmap.querySelector('iframe').style.pointerEvents = 'none';\n}, false);\n"]}